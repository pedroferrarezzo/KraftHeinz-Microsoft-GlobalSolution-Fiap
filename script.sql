
-- TABLES

CREATE TABLE T_USER (
    id NUMBER(0,15) GENERATED BY DEFAULT ON NULL AS IDENTITY,
    username VARCHAR2(100) NOT NULL,
    id_doc_type NUMBER(0,15) NOT NULL,
    doc_number VARCHAR2(50) NOT NULL,
    birth_date timestamp,
    creation_date timestamp,
    CONSTRAINT pk_t_user PRIMARY KEY (id)
);

CREATE TABLE T_DOC_TYPE (
    id NUMBER(0,15) GENERATED BY DEFAULT ON NULL AS IDENTITY,
    doc_description VARCHAR2(20) NOT NULL,
    CONSTRAINT pk_t_doc_type PRIMARY KEY (id)
);

CREATE TABLE T_DEVICE (
    id NUMBER(0,15) GENERATED BY DEFAULT ON NULL AS IDENTITY,
    device_name VARCHAR2(30) NOT NULL,
    device_description VARCHAR2(50),
    CONSTRAINT pk_t_device PRIMARY KEY (id)
);

CREATE TABLE T_FOOD (
    id NUMBER(0,15) GENERATED BY DEFAULT ON NULL AS IDENTITY,
    id_type NUMBER(0,15) NOT NULL,
    food_description VARCHAR2(30) NOT NULL,
    CONSTRAINT pk_t_food PRIMARY KEY (id)
);

CREATE TABLE T_FOOD_TYPE (
    id NUMBER(0,15) GENERATED BY DEFAULT ON NULL AS IDENTITY,
    type_description VARCHAR2(50) NOT NULL,
    CONSTRAINT pk_t_food_type PRIMARY KEY (id)
);

CREATE TABLE T_FOOD_VALIDATE (
    id NUMBER(0,15) GENERATED BY DEFAULT ON NULL AS IDENTITY,
    id_food NUMBER(0,15) NOT NULL,
    expiration_date TIMESTAMP,
    CONSTRAINT pk_t_expiration_date PRIMARY KEY (id)
);

CREATE TABLE T_ANALYSIS (
    id NUMBER(0,15) GENERATED BY DEFAULT ON NULL AS IDENTITY,
    id_user NUMBER(0,15) NOT NULL,
    id_food NUMBER(0,15) NOT NULL,
    id_device NUMBER(0,15) NOT NULL,
    creation_date TIMESTAMP,
    CONSTRAINT pk_t_analysis PRIMARY KEY (id)
);

-- CONSTRAINTS

ALTER TABLE T_USER ADD CONSTRAINT FK_T_DOC_TYPE FOREIGN KEY (id_doc_type) REFERENCES T_DOC_TYPE (id);
ALTER TABLE T_FOOD ADD CONSTRAINT FK_T_FOOD_TYPE FOREIGN KEY (id_type) REFERENCES T_FOOD_TYPE (id);
ALTER TABLE T_FOOD_VALIDATE ADD CONSTRAINT FK_T_FV_FOOD FOREIGN KEY (id_food) REFERENCES T_FOOD (id);
ALTER TABLE T_ANALYSIS ADD CONSTRAINT FK_T_USER FOREIGN KEY (id_user) REFERENCES T_USER (id);
ALTER TABLE T_ANALYSIS ADD CONSTRAINT FK_T_A_FOOD FOREIGN KEY (id_food) REFERENCES T_FOOD (id);
ALTER TABLE T_ANALYSIS ADD CONSTRAINT FK_T_DEVICE FOREIGN KEY (id_device) REFERENCES T_DEVICE (id);